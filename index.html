<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador Financeira</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f9fbff;
      color: #1a1a1a;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      background: #fff;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #007aff;
      margin-bottom: 20px;
    }
    .form-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 6px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid #ddd;
      font-size: 15px;
    }
    button {
      background: #007aff;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }
    button:hover {
      background: #005bb5;
    }
    .buttons {
      display: flex;
      justify-content: center;
      margin: 40px 0; /* aumentei o espaçamento */
      gap: 30px;      /* aumentei o espaçamento */
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 12px;
      text-align: center;
    }
    th {
      background: #007aff;
      color: white;
    }
    tr:nth-child(even) {
      background: #f2f6ff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Simulador de Recebíveis</h1>
    <div class="form-section">
      <div>
        <label>Vendas por mês</label>
        <input type="number" id="vendasMes" value="10">
      </div>
      <div>
        <label>Valor de cada venda (R$)</label>
        <input type="number" id="valorVenda" value="300">
      </div>
      <div>
        <label>Número de parcelas</label>
        <input type="number" id="parcelas" value="4">
      </div>
      <div>
        <label>Meses de vendas recorrentes</label>
        <input type="number" id="mesesRecorrentes" value="4">
      </div>
      <div>
        <label>Desconto fixo mensal (R$)</label>
        <input type="number" id="descontoMensal" value="150">
      </div>
      <div>
        <label>Taxa por parcela (R$)</label>
        <input type="number" id="taxaParcela" value="4.9">
      </div>
      <div>
        <label>Tipo de desconto</label>
        <select id="tipoDesconto">
          <option value="total">Descontar total do mês (ex.: 701)</option>
          <option value="parcelado">Descontar parcelado (ex.: 49 em cada parcela)</option>
        </select>
      </div>
    </div>
    <div class="buttons">
      <button onclick="simular()">Simular</button>
      <button onclick="limpar()" style="background:#999">Limpar</button>
    </div>
    <div id="resultado"></div>
  </div>

  <script>
    function simular() {
      const vendasMes = parseInt(document.getElementById('vendasMes').value);
      const valorVenda = parseFloat(document.getElementById('valorVenda').value);
      const parcelas = parseInt(document.getElementById('parcelas').value);
      const mesesRecorrentes = parseInt(document.getElementById('mesesRecorrentes').value);
      const descontoMensal = parseFloat(document.getElementById('descontoMensal').value);
      const taxaParcela = parseFloat(document.getElementById('taxaParcela').value);
      const tipoDesconto = document.getElementById('tipoDesconto').value;

      const valorParcela = valorVenda / parcelas;
      const totalGrupo = vendasMes * valorVenda; // total vendido no mês
      const parcelaGrupoBruta = valorParcela * vendasMes; // quanto recebe por parcela (sem taxa)
      const taxaTotalGrupo = taxaParcela * parcelas * vendasMes; // taxa total por grupo de vendas
      const taxaParcelaGrupo = taxaTotalGrupo / parcelas; // taxa dividida em cada parcela

      let meses = [];
      let ultimoMes = mesesRecorrentes + parcelas; // vai até o último recebimento

      for (let m = 0; m < ultimoMes; m++) {
        let recebimentoBruto = 0;
        let descontoTaxa = 0;

        // simula recebimentos de cada mês de venda
        for (let v = 0; v < mesesRecorrentes; v++) {
          if (m >= v+1 && m <= v+parcelas) {
            if (tipoDesconto === 'total') {
              // aplica desconto total já diluído na parcela
              recebimentoBruto += (totalGrupo - taxaTotalGrupo) / parcelas;
            } else {
              // aplica desconto parcelado (taxa dividida em cada parcela)
              recebimentoBruto += parcelaGrupoBruta - taxaParcelaGrupo;
            }
          }
        }

        let descontoFixo = m === 0 ? 0 : descontoMensal;
        let liquido = recebimentoBruto - descontoFixo;

        meses.push({
          mes: `Mês ${m+1}`,
          bruto: recebimentoBruto,
          taxa: tipoDesconto === 'total' ? taxaTotalGrupo/parcelas : taxaParcelaGrupo,
          fixo: descontoFixo,
          liquido: liquido
        });
      }

      let html = `<table><tr><th>Mês</th><th>Receita Bruta (R$)</th><th>Taxas (R$)</th><th>Desconto Mensal (R$)</th><th>Receita Líquida (R$)</th></tr>`;
      meses.forEach(l => {
        html += `<tr>
          <td>${l.mes}</td>
          <td>${l.bruto.toFixed(2)}</td>
          <td>${l.taxa.toFixed(2)}</td>
          <td>${l.fixo.toFixed(2)}</td>
          <td><b>${l.liquido.toFixed(2)}</b></td>
        </tr>`;
      });
      html += `</table>`;

      document.getElementById('resultado').innerHTML = html;
    }

    function limpar() {
      document.getElementById('resultado').innerHTML = "";
    }
  </script>
</body>
</html>
